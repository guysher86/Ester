/* One-pager (RTL) – minimal, bright, Apple-ish */
:root{
  --bg: #ffffff;
  --text: #0b0f14;
  --muted: #5a6674;
  --line: rgba(11,15,20,.10);
  --soft: rgba(11,15,20,.03);
  --shadow: 0 16px 40px rgba(11,15,20,.10);
  --r: 24px;
  --r2: 16px;
  --max: 760px;
}

*{ box-sizing: border-box; }
html,body{ height: 100%; }
body{
  margin: 0;
  font-family: "Heebo", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.45;
}

a{ color: inherit; }
.container{
  width: min(var(--max), calc(100% - 40px));
  margin-inline: auto;
}

.skip{
  position: absolute;
  inset-inline-start: 12px;
  top: 12px;
  padding: 10px 12px;
  border-radius: 12px;
  background: var(--text);
  color: #fff;
  transform: translateY(-160%);
  transition: transform .2s ease;
  z-index: 50;
}
.skip:focus{ transform: translateY(0); }

.hero{
  padding: 56px 0 34px;
  border-bottom: 1px solid var(--line);
}

.topline{
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 14px;
}
.pill{
  font-size: 12px;
  font-weight: 800;
  letter-spacing: .04em;
  padding: 8px 12px;
  border-radius: 999px;
  background: rgba(11,15,20,.06);
  border: 1px solid var(--line);
}
.topline-muted{ color: var(--muted); font-size: 13px; }
.topline-sep{ color: var(--muted); }

.h1{
  margin: 0;
  font-size: clamp(30px, 4.2vw, 48px);
  letter-spacing: -0.02em;
}
.h2{
  margin: 0 0 14px;
  font-size: 22px;
  letter-spacing: -0.01em;
}
.lede{
  margin: 14px 0 0;
  font-size: 18px;
  color: var(--muted);
  max-width: 58ch;
}
.lede.small{ font-size: 15px; margin-top: 8px; }

.trust{
  margin-top: 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  color: var(--muted);
  font-size: 13px;
}
.trust-dot{ opacity: .7; }

.cta{
  margin-top: 18px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.btn{
  border: 0;
  border-radius: 999px;
  padding: 14px 16px;
  font-weight: 800;
  font-size: 16px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  transition: transform .06s ease, opacity .2s ease, box-shadow .25s ease;
}
.btn:active{ transform: translateY(1px); }
.btn-primary{
  background: var(--text);
  color: #fff;
  box-shadow: 0 14px 26px rgba(11,15,20,.20);
}
.btn-primary:hover{ opacity: .95; }
.btn-ghost{
  background: transparent;
  color: var(--text);
  border: 1px solid var(--line);
}
.btn-ghost:hover{ box-shadow: 0 12px 24px rgba(11,15,20,.10); }
.btn-wide{ width: 100%; }

.micro{
  margin: 12px 0 0;
  color: var(--muted);
  font-size: 13px;
}

.section{ padding: 54px 0; }
.section.subtle{
  background: rgba(11,15,20,.02);
  border-top: 1px solid var(--line);
  border-bottom: 1px solid var(--line);
}

.stack{ display: flex; flex-direction: column; gap: 14px; }

.card{
  padding: 18px 18px;
  border-radius: var(--r);
  background: var(--soft);
  border: 1px solid var(--line);
}
.card-title{ font-weight: 800; }
.card-text{ color: var(--muted); margin-top: 6px; }

.row{
  padding: 16px 16px;
  border-radius: var(--r);
  background: #fff;
  border: 1px solid var(--line);
}
.row-title{ font-weight: 800; }
.row-text{ color: var(--muted); margin-top: 4px; }

.form{
  margin-top: 10px;
  padding: 20px;
  border-radius: var(--r);
  background: #fff;
  border: 1px solid var(--line);
  box-shadow: var(--shadow);
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.field{ display: flex; flex-direction: column; gap: 8px; }
.label{ font-weight: 800; font-size: 13px; }
.input{
  width: 100%;
  padding: 14px 14px;
  border-radius: var(--r2);
  border: 1px solid var(--line);
  background: rgba(11,15,20,.02);
  font-size: 16px;
  outline: none;
}
.input:focus{
  background: #fff;
  border-color: rgba(11,15,20,.22);
}

.fine{
  margin: 0;
  font-size: 12px;
  color: var(--muted);
}
.note{
  min-height: 18px;
  font-size: 13px;
  color: var(--muted);
}

.faq{
  padding: 16px 16px;
  border-radius: var(--r);
  border: 1px solid var(--line);
  background: #fff;
  margin-top: 12px;
}
.faq summary{ cursor: pointer; font-weight: 800; }
.faq p{ color: var(--muted); margin: 10px 0 0; }

.footer{
  padding: 26px 0 94px;
  border-top: 1px solid var(--line);
}
.footer-line{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
}
.footer-strong{ font-weight: 800; }
.footer-link{ color: var(--muted); text-decoration: none; border-bottom: 1px solid transparent; }
.footer-link:hover{ border-bottom-color: rgba(11,15,20,.18); }
.footer-sep{ color: var(--muted); }
.footer-small{ color: var(--muted); font-size: 12px; margin-top: 8px; }

/* Sticky CTA on mobile */
.sticky{
  position: fixed;
  inset-inline: 0;
  bottom: 0;
  padding: 12px 12px max(12px, env(safe-area-inset-bottom));
  background: rgba(255,255,255,.86);
  backdrop-filter: blur(10px);
  border-top: 1px solid var(--line);
  display: none;
  z-index: 40;
}
@media (max-width: 780px){
  .sticky{ display: block; }
}

/* Minimal Apple-ish reveal */
[data-reveal]{
  opacity: 0;
  transform: translateY(10px);
  filter: blur(1.5px);
  will-change: transform, opacity, filter;
}
[data-reveal].is-visible{
  opacity: 1;
  transform: translateY(0);
  filter: blur(0);
  transition:
    opacity .55s cubic-bezier(.2,.8,.2,1),
    transform .65s cubic-bezier(.2,.8,.2,1),
    filter .65s cubic-bezier(.2,.8,.2,1);
}
@media (prefers-reduced-motion: reduce){
  [data-reveal]{ opacity: 1 !important; transform: none !important; filter: none !important; transition: none !important; }
}
(function () {
  const PHONE = (window.__WHATSAPP_PHONE__ || "").trim();

  const form = document.getElementById("whatsappForm");
  const note = document.getElementById("formNote");
  const year = document.getElementById("year");

  const stickyBtn = document.getElementById("stickyWhatsApp");
  const quickBtn = document.getElementById("quickWhatsApp");

  if (year) year.textContent = String(new Date().getFullYear());

  const reduceMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  function openWhatsApp(message) {
    if (!PHONE) {
      if (note) note.textContent = "צריך לעדכן את מספר ה‑WhatsApp בקוד (window.__WHATSAPP_PHONE__).";
      return;
    }
    const url = `https://wa.me/${PHONE}?text=${encodeURIComponent(message)}`;
    window.open(url, "_blank", "noopener,noreferrer");
  }

  function buildMessage(data) {
    return [
      "היי, אשמח לשיעורים פרטיים במתמטיקה בחיפה.",
      "",
      `שם ההורה: ${data.parentName}`,
      `כיתה: ${data.grade}`,
      `נושא כרגע: ${data.topic}`,
      `טלפון לחזרה: ${data.phone}`,
    ].join("\n");
  }

  function getFormData() {
    const fd = new FormData(form);
    return {
      parentName: String(fd.get("parentName") || "").trim(),
      grade: String(fd.get("grade") || "").trim(),
      topic: String(fd.get("topic") || "").trim(),
      phone: String(fd.get("phone") || "").trim(),
    };
  }

  function validate(data) {
    return data.parentName && data.grade && data.topic && data.phone;
  }

  if (form) {
    form.addEventListener("submit", function (e) {
      e.preventDefault();
      if (note) note.textContent = "";

      const data = getFormData();
      if (!validate(data)) {
        if (note) note.textContent = "כדי לפתוח שיחה, מלאו את כל השדות.";
        return;
      }
      openWhatsApp(buildMessage(data));
    });
  }

  function genericMessage() {
    return "היי, אשמח לשיעורים פרטיים במתמטיקה בחיפה. אפשר לדבר?";
  }

  if (quickBtn) {
    quickBtn.addEventListener("click", function () {
      openWhatsApp(genericMessage());
    });
  }

  if (stickyBtn) {
    stickyBtn.addEventListener("click", function () {
      let msg = genericMessage();
      if (form) {
        const data = getFormData();
        if (validate(data)) msg = buildMessage(data);
      }
      openWhatsApp(msg);
      const lead = document.getElementById("lead");
      if (lead) lead.scrollIntoView({ behavior: "smooth", block: "start" });
    });
  }

  // Minimal scroll reveal (Apple-ish, not flashy)
  function initReveal() {
    const els = Array.from(document.querySelectorAll("[data-reveal]"));
    if (!els.length) return;

    if (reduceMotion) {
      els.forEach(el => el.classList.add("is-visible"));
      return;
    }

    const io = new IntersectionObserver((entries) => {
      for (const entry of entries) {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          io.unobserve(entry.target);
        }
      }
    }, {
      threshold: 0.12,
      rootMargin: "0px 0px -12% 0px",
    });

    els.forEach(el => io.observe(el));
  }

  initReveal();
})();
